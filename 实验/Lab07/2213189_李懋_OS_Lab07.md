# OS_Lab07

| **姓名** | **李懋**                       |
| -------- | ------------------------------ |
| **学号** | **2213189**                    |
| **邮箱** | **2213189@mail.nankai.edu.cn** |



## 1 实验题目

- 多线程拷贝目录及子目录



## 2 实验目的

1. 掌握多线程编程的基本概念和实现方法。
2. 理解多线程在文件拷贝中的应用，比较单进程、多进程和多线程在文件拷贝中的效率差异。
3. 学习使用POSIX线程库（pthread）进行多线程编程。
4. 掌握目录遍历和文件操作的基本方法。
5. 验证多线程拷贝目录的正确性，并比较不同方法的优缺点。



## 3 实验原理

1. **多线程编程**：
   - 使用POSIX线程库（pthread）创建和管理线程。
   - 线程之间共享进程的资源，但需要通过互斥量（mutex）来保护共享资源，避免竞态条件。
2. **目录遍历**：
   - 使用`opendir()`、`readdir()`和`closedir()`函数遍历目录。
   - 通过`struct dirent`结构体获取目录项的信息，包括文件名和文件类型。
3. **文件拷贝**：
   - 使用`open()`、`read()`、`write()`和`close()`函数进行文件的读写操作。
   - 使用`mkdir()`函数创建目标目录。
4. **生产者-消费者模型**：
   - 一个线程负责遍历源目录并将文件路径放入待拷贝文件的数组中（生产者）。
   - 多个线程负责从数组中取出文件路径并进行拷贝（消费者）。
   - 使用互斥量保护共享的数组，确保线程安全。



## 4 实验具体步骤

1. Install GCC（不再多赘述）
2. Linux源码包已经准备好了